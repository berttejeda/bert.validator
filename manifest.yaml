vars:
  my_global_var: "{{ .USER }}_my_global_value"
  {{ .USER }}: "{{ .USER }}"

templateVars:
  myvar_3: value_3
  function_test: |-
    function function_test(){
      echo -e Parameter 1 value is ${yellow}${1}${nc}
      echo -e Parameter 2 value is ${red}${2}${nc}
      echo -e My Global Var is ${my_global_var}
    }
  items:
    - name: one
      value: 1
    - name: two
      value: 2
    - name: three
      value: 3

validations:
  - name: "FunctionTest"
    show_output: true
    script: |-
      {{ printf "%s\n" .function_test | nindent 6 }}
      function_test 1 2
      echo -e ${yellow}Yellow${nc} ${red}Red${nc}
      echo "Length is ${length}"
      echo "Count is ${count}"
      echo "Your public IP is ${public_ip}"
      if (( length < 4 )); then
        exit 0
      else
        exit 1
      fi
    outcomes:
      fail:
        message: Length ${length} is more than 4 for site ${SITE_NAME}!
      pass:
        message: Length ${length} is less than 4 for site ${SITE_NAME}!
    vars:
      length: 0
      count: 5
      public_ip: $(curl -s ifconfig.me)
